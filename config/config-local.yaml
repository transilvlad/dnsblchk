# Configuration for DNS RBL Checker.

# General settings.
run_once: true  # If true, the script will run once and then exit.
sleep_hours: 3   # Hours to sleep between checks if run_once is false.
keep_last_reports: 5 # Number of latest reports to keep, older ones will be deleted after notifications.

# File paths.
servers_file: "config/servers.txt" # File containing the list of RBL servers.
ips_file: "config/ips.txt"         # File containing the list of IP addresses to check.
report_dir: "logs/"                # Directory for storing report files.

# DNS Nameservers for DNS RBL queries.
nameservers:
  - "208.67.222.222"  # OpenDNS nameserver.
  - "208.67.220.220"  # OpenDNS nameserver (secondary).

# Threading settings.
threading:
  enabled: true    # Enable multithreading for DNS RBL checks (default: true).
  thread_count: 10 # Number of worker threads (default: 10, minimum: 1).

# Email alerting.
email:
  enabled: false # If true, an email report will be sent if there are listed IPs.
  recipients:
    - "tony@example.com"
  sender: "dnsblchk@example.com"
  smtp_host: "localhost"
  smtp_port: 25
  # Optional SMTP authentication.
  smtp_user: ""         # Username for SMTP AUTH (leave empty if not needed).
  smtp_password: ""     # Password for SMTP AUTH (leave empty if not needed).
  # Encryption settings (choose one).
  use_tls: false         # Use STARTTLS (typical port 587).
  use_ssl: false         # Use implicit SSL (typical port 465). If true, overrides use_tls.

# Webhook alerting.
webhooks:
  enabled: true # If true, webhook notifications will be sent if there are listed IPs.
  # List of webhook URLs to post notifications to (e.g., ["https://example.com/webhook"]).
  urls: ["https://dnsblchk.requestcatcher.com/"]
  timeout: 10    # Timeout in seconds for webhook requests (default: 10).

# API-based IP update.
api_update:
  enabled: false # If true, IP addresses will be fetched from an API before each check run.
  url: ""        # API endpoint URL that returns text/plain with one IP per line.
  # Authentication settings.
  auth_type: "none"    # Authentication type: 'none', 'basic', or 'bearer' (default: 'none').
  username: ""         # Username for basic authentication (required if auth_type is 'basic').
  password: ""         # Password for basic authentication (required if auth_type is 'basic').
  bearer_token: ""     # Bearer token for bearer authentication (required if auth_type is 'bearer').
  timeout: 10          # Timeout in seconds for API requests (default: 10).

# Logging settings.
logging:
  level: "DEBUG"                # Logging level: DEBUG, INFO, WARN, ERROR (default: INFO).
  console_print: true           # Print logs to console in addition to file (default: true).
  log_dir: "logs/"              # Directory for log files.
  log_file: "dnsblchk.log"      # Log filename (will be combined with log_dir).
  clear_log_on_start: true      # If true, erase log file contents before starting to log.
